<!DOCTYPE html>
<html><head></head>
<body>
<input type="text" id="d"></input>duty cycle (in percent)<br>
<input type="text" id="f"></input>frequency (ignored if custom value used)<br>
<input type="text" id="t"></input>time (in samples)<br>
<input type="text" id="q"></input>sample rate<br>
<input type="text" id="a"></input>amplitude<br>
<input type="text" id="b"></input>dc bias (1=100%)<br>
<input type="text" id="c"></input>custom value used (type yes to enable)<br>
<input type="text" id="v"></input>custom value (ignored if custom value used box does not say "yes")<br>



<button onclick="run()">
start
</button>
<script>const REAL_TIME_FREQUENCY = 440;
const ANGULAR_FREQUENCY = REAL_TIME_FREQUENCY * 2 * Math.PI;
function z(a){
return parseFloat(document.getElementById(a).value)
}
function y(a){
return document.getElementById(a).value
}
function amod(a,b){
return a-(Math.floor(a/b)*b)
}
function generateSample(sampleNumber,f,d,a,b) {
  let currentTime = sampleNumber / z("q");
  let currentAngle = currentTime * ANGULAR_FREQUENCY;
  return amod(sampleNumber,(y("c")=="yes"?z("v"):z("q")/f))<=((y("c")=="yes"?z("v"):z("q")/f)*(d/100))?a+b:-a+b
}
let audioContext = new AudioContext();
function run(){
let myBuffer = audioContext.createBuffer(1, z("t"), z("q"));
let myArray = myBuffer.getChannelData(0);
for (let sampleNumber = 0 ; sampleNumber < z("t"); sampleNumber++) {
  myArray[sampleNumber] = generateSample(sampleNumber,z("f"),z("d"),z("a"),z("b"));
}


let src = audioContext.createBufferSource();
src.buffer = myBuffer;
src.connect(audioContext.destination);
src.start();
}</script>
</body>
</html>
